<!doctype html>
<meta charset="utf-8">
<style>
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: sans-serif;
  }
  .container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    height: 100vh;
  }
  textarea, pre {
    margin: 0;
    padding: 1em;
    font-size: 1rem;
    border: none;
    outline: none;
    height: 100%;
    box-sizing: border-box;
  }
  textarea {
    resize: none;
    border-right: 1px solid #333;
  }
  pre {
    background: #111;
    color: #eee;
    white-space: pre-wrap;
    overflow: auto;
  }
  @media (max-width: 700px) {
    .container {
      grid-template-columns: 1fr;
      grid-template-rows: 1fr 1fr;
    }
    textarea {
      border-right: none;
      border-bottom: 1px solid #333;
    }
  }
</style>

<div class="container">
  <textarea id="input">Hello, Rust!</textarea>
  <pre id="output"></pre>
</div>

<script>
const input = document.getElementById("input");
const output = document.getElementById("output");
let timer;
input.addEventListener("input", () => {
  clearTimeout(timer);
  timer = setTimeout(async () => {
    const res = await fetch("/run", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ text: input.value })
    });
    const data = await res.json();
    output.textContent = data.result;
  }, 150);
});
</script>